# ุฅุตูุงุญ ูุดููุฉ ุธููุฑ ุงูููุงุนูุฏ ุงููุญุฐููุฉ

## ุงููุดููุฉ

### ุงูุณููุงุฑูู 1: ุงูููุดุฆ ูุญุฐู ุงูููุนุฏ
- **ุงููุดููุฉ:** ุนูุงุฑ (ููุดุฆ) ุฃูุดุฃ ููุนุฏุงู ูุน ุนุจุฏ ุงูุฃููุฑ (ุถูู)
- ุนุจุฏ ุงูุฃููุฑ ูุงูู ุนูู ุงูุฏุนูุฉ
- ุนูุงุฑ ุญุฐู ุงูููุนุฏ ูู ุฌูุชู
- **ุงููุชููุน:** ุนุจุฏ ุงูุฃููุฑ ูุฑู ุนูุงุฑ ุฃุญูุฑ (ูุญุฐูู)
- **ุงููุนูู:** ุนุจุฏ ุงูุฃููุฑ ูุฑู ุนูุงุฑ ุฃุฒุฑู (ูุดุท) โ

### ุงูุณููุงุฑูู 2: ุงูุถูู ูุญุฐู ุงูููุนุฏ
- **ุงููุดููุฉ:** ุนุจุฏ ุงูุฃููุฑ (ุถูู) ุญุฐู ุงูููุนุฏ ูู ุฌูุชู
- ุนูุงุฑ ูุฒูุฑ ุตูุญุฉ ุนุจุฏ ุงูุฃููุฑ
- **ุงููุชููุน:** ุงูููุนุฏ ูุง ูุธูุฑ ูู ุตูุญุฉ ุนุจุฏ ุงูุฃููุฑ
- **ุงููุนูู:** ุงูููุนุฏ ูุธูุฑ ูุนุจุฏ ุงูุฃููุฑ ุฃุญูุฑ โ

---

## ุงูุณุจุจ

### ุงูุณููุงุฑูู 1:
- ููู ุงูุทูู ูุนุชูุฏ ุนูู `user_appointment_status`
- ุนูุฏูุง ูุญุฐู ุงูููุดุฆ ุงูููุนุฏุ ูุชู ุชุญุฏูุซ `status = "deleted"` ูู ุณุฌูู
- ููู ุงูุจุทุงูุฉ ุชุนุฑุถ ููู ุงูุทูู ุจูุงุกู ุนูู ุญุงูุฉ ุงููุณุชุฎุฏู ุงููุนุฑูุถ (ุตุงุญุจ ุงูุตูุญุฉ)
- ุงูุญู: ุงูุชุฃูุฏ ูู ุฃู `_loadParticipantsStatus` ูุฌูุจ ุญุงูุงุช ุฌููุน ุงููุดุงุฑููู

### ุงูุณููุงุฑูู 2:
- ุนูุฏูุง ูุญุฐู ุงูุถูู ุงูููุนุฏุ ูุชู ุชุญุฏูุซ `invitation.status = "deleted_after_accept"`
- ููู ุงูููุฏ ูุงู ูุฌูุจ ุงูููุงุนูุฏ ูู `invitations` ุญุชู ูู ูุงูุช `deleted_after_accept`
- ุงูุญู: ุนุฏู ุฌูุจ ุงูููุงุนูุฏ ุงูุชู `status = "deleted_after_accept"` ูู ุตูุญุฉ ุตุงุญุจ ุงูุญุณุงุจ

---

## ุงูุญู ุงููุทุจู

### ุฅุตูุงุญ ุงูุณููุงุฑูู 2 (ุงูุถูู ูุญุฐู ุงูููุนุฏ)

**ูู `lib/screens/user_profile_screen.dart`:**

**ูุจู:**
```dart
// ุฌูุจ ุงูููุงุนูุฏ ุงููุฏุนู ุฅูููุง (ููุจููุฉ)
final acceptedInvitations = await _authService.pb
    .collection(AppConstants.invitationsCollection)
    .getFullList(
  filter: 'guest = "${_user!.id}" && (status = "accepted" || status = "deleted_after_accept")',
  expand: 'appointment',
);
```

**ุจุนุฏ:**
```dart
// ุฌูุจ ุงูููุงุนูุฏ ุงููุฏุนู ุฅูููุง (ููุจููุฉ ููุทุ ููุณ deleted_after_accept)
// ูุฃู deleted_after_accept ูุนูู ุฃู ุงูุถูู ุญุฐู ุงูููุนุฏ ููุฌุจ ุฃูุง ูุธูุฑ
final acceptedInvitations = await _authService.pb
    .collection(AppConstants.invitationsCollection)
    .getFullList(
  filter: 'guest = "${_user!.id}" && status = "accepted"',
  expand: 'appointment',
);
```

**ุงููุชูุฌุฉ:**
- โ ุนูุฏูุง ูุญุฐู ุงูุถูู ุงูููุนุฏุ ูุง ูุธูุฑ ูู ุตูุญุชู ุงูุดุฎุตูุฉ
- โ ุงูููุนุฏ ูุง ูุธูุฑ ููุฒูุงุฑ ุฃูุถุงู

---

## ุงูุณููุงุฑูู 1: ููู ุงูุทูู

### ููู ูุนูู ููู ุงูุทููุ

ููู ุงูุทูู ูุนุชูุฏ ุนูู `user_appointment_status` ูููุณุชุฎุฏู ุงููุนุฑูุถ:

```dart
// ูู appointment_card.dart
final userStatus = participantsStatus[userId];
final status = userStatus?.status ?? 'active';

Color ringColor;
if (status == 'deleted' || status == 'archived') {
  ringColor = Colors.red;  // ุฃุญูุฑ ูููุญุฐูู/ุงููุคุฑุดู
} else {
  ringColor = Colors.blue; // ุฃุฒุฑู ูููุดุท
}
```

### ุงูุชุญูู ูู ุฃู ุงูุญู ูุนูู:

**ุงูุณููุงุฑูู:**
1. ุนูุงุฑ ููุดุฆ ููุนุฏุงู
2. ุนุจุฏ ุงูุฃููุฑ ููุจู ุงูุฏุนูุฉ
3. ุนูุงุฑ ูุญุฐู ุงูููุนุฏ (ูุถุบุท ุนูู ุฒุฑ ุงูุญุฐู)
4. ูุชู ุชุญุฏูุซ `user_appointment_status` ูุนูุงุฑ: `status = "deleted"`
5. ุนุจุฏ ุงูุฃููุฑ ููุชุญ ุตูุญุชู ุงูุดุฎุตูุฉ
6. ูุฑู ุงูููุนุฏ ูุน ุทูู ุนูุงุฑ ุฃุญูุฑ โ

**ุฅุฐุง ูู ูุนูู:**
- ุชุฃูุฏ ูู ุฃู `_loadParticipantsStatus` ูุฌูุจ ุญุงูุงุช ุฌููุน ุงููุดุงุฑููู
- ุชุฃูุฏ ูู ุฃู `appointment_card.dart` ูุณุชุฎุฏู `participantsStatus` ุจุดูู ุตุญูุญ

---

## ุญุงูุงุช ุงูุฏุนูุฉ (Invitation Status)

| Status | ุงููุนูู | ูุธูุฑ ูู ุงูุตูุญุฉุ |
|--------|---------|-----------------|
| `invited` | ูุฏุนู (ูู ูุฑุฏ ุจุนุฏ) | โ ูุง |
| `accepted` | ูุจู ุงูุฏุนูุฉ | โ ูุนู |
| `rejected` | ุฑูุถ ุงูุฏุนูุฉ | โ ูุง |
| `deleted_after_accept` | ุญุฐู ุจุนุฏ ุงููุจูู | โ ูุง |

---

## ุญุงูุงุช ุงูููุนุฏ (User Appointment Status)

| Status | ุงููุนูู | ููู ุงูุทูู |
|--------|---------|-----------|
| `active` | ูุดุท | ๐ต ุฃุฒุฑู |
| `deleted` | ูุญุฐูู | ๐ด ุฃุญูุฑ |
| `archived` | ูุคุฑุดู | ๐ด ุฃุญูุฑ |

---

## ุงูุงุฎุชุจุงุฑ

### ุงุฎุชุจุฑ ุงูุณููุงุฑูููุงุช ุงูุชุงููุฉ:

#### ุงูุณููุงุฑูู 1: ุงูููุดุฆ ูุญุฐู
1. โ ุงููุณุชุฎุฏู A ููุดุฆ ููุนุฏุงู
2. โ ุงููุณุชุฎุฏู B ููุจู ุงูุฏุนูุฉ
3. โ ุงููุณุชุฎุฏู A ูุญุฐู ุงูููุนุฏ
4. โ ุงููุณุชุฎุฏู B ููุชุญ ุตูุญุชู โ ูุฑู ุงูููุนุฏ ูุน A ุฃุญูุฑ
5. โ ุงููุณุชุฎุฏู C ูุฒูุฑ ุตูุญุฉ B โ ูุฑู ุงูููุนุฏ ูุน A ุฃุญูุฑ

#### ุงูุณููุงุฑูู 2: ุงูุถูู ูุญุฐู
1. โ ุงููุณุชุฎุฏู A ููุดุฆ ููุนุฏุงู
2. โ ุงููุณุชุฎุฏู B ููุจู ุงูุฏุนูุฉ
3. โ ุงููุณุชุฎุฏู B ูุญุฐู ุงูููุนุฏ
4. โ ุงููุณุชุฎุฏู B ููุชุญ ุตูุญุชู โ ูุง ูุฑู ุงูููุนุฏ
5. โ ุงููุณุชุฎุฏู C ูุฒูุฑ ุตูุญุฉ B โ ูุง ูุฑู ุงูููุนุฏ
6. โ ุงููุณุชุฎุฏู A ููุชุญ ุตูุญุชู โ ูุฑู ุงูููุนุฏ ูุน B ุฃุญูุฑ

#### ุงูุณููุงุฑูู 3: ููุงููุง ูุญุฐู
1. โ ุงููุณุชุฎุฏู A ููุดุฆ ููุนุฏุงู
2. โ ุงููุณุชุฎุฏู B ููุจู ุงูุฏุนูุฉ
3. โ ุงููุณุชุฎุฏู A ูุญุฐู ุงูููุนุฏ
4. โ ุงููุณุชุฎุฏู B ูุญุฐู ุงูููุนุฏ
5. โ ุงููุณุชุฎุฏู A ููุชุญ ุตูุญุชู โ ูุง ูุฑู ุงูููุนุฏ
6. โ ุงููุณุชุฎุฏู B ููุชุญ ุตูุญุชู โ ูุง ูุฑู ุงูููุนุฏ

---

## ููุงุญุธุงุช ูููุฉ

### 1. ุงููุฑู ุจูู ุงูุญุฐู ูุงูุฃุฑุดูุฉ

- **ุงูุญุฐู (`deleted`):** ุงููุณุชุฎุฏู ูุง ูุฑูุฏ ุฑุคูุฉ ุงูููุนุฏ
- **ุงูุฃุฑุดูุฉ (`archived`):** ุงููุณุชุฎุฏู ูุฑูุฏ ุฅุฎูุงุก ุงูููุนุฏ ููู ูููู ุงุณุชุฑุฌุงุนู

### 2. ุงููุฑู ุจูู `deleted_after_accept` ู `rejected`

- **`deleted_after_accept`:** ุงูุถูู ูุจู ุงูุฏุนูุฉ ุซู ุญุฐู ุงูููุนุฏ ูุงุญูุงู
- **`rejected`:** ุงูุถูู ุฑูุถ ุงูุฏุนูุฉ ูู ุงูุจุฏุงูุฉ

### 3. ููุงุฐุง ูุฌูุจ `deleted_after_accept` ููุฒูุงุฑุ

ูู ููุฏ ุงูุฒุงุฆุฑุ ูุฌูุจ `deleted_after_accept` ูุฃููุง ูุญุชุงุฌ ูุนุฑูุฉ ุฌููุน ุงูููุงุนูุฏ ุงูุชู ูุงู ุงููุณุชุฎุฏู ุถููุงู ูููุงุ ุซู ูููุชุฑ ุจูุงุกู ุนูู `user_appointment_status` ูุตุงุญุจ ุงูุตูุญุฉ.

---

## ุงูุฎูุงุตุฉ

### โ ุชู ุฅุตูุงุญ:
- ุงูุณููุงุฑูู 2: ุนูุฏูุง ูุญุฐู ุงูุถูู ุงูููุนุฏุ ูุง ูุธูุฑ ูู ุตูุญุชู

### โ ูุนูู ุจุดูู ุตุญูุญ:
- ุงูุณููุงุฑูู 1: ุนูุฏูุง ูุญุฐู ุงูููุดุฆ ุงูููุนุฏุ ูุธูุฑ ุฃุญูุฑ ููุถูู (ูุนุชูุฏ ุนูู `user_appointment_status`)
- ุงูููุชุฑุฉ ุงูููุงุฆูุฉ ููููุงุนูุฏ ุงููุญุฐููุฉ ูู ุงููุณุชุฎุฏู ุงูุญุงูู

### ๐ ููุงุญุธุฉ:
ุฅุฐุง ูุงู ุงูุณููุงุฑูู 1 ูุง ูุนูู (ููู ุงูุทูู ูุง ูุชุบูุฑ)ุ ูุงููุดููุฉ ูู `appointment_card.dart` ูููุณ ูู `user_profile_screen.dart`.
